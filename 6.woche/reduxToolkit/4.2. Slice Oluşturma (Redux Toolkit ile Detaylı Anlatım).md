# ğŸš€ **4.2. Slice OluÅŸturma (Redux Toolkit ile DetaylÄ± AnlatÄ±m)** ğŸš€

**Slice**, Redux Toolkitâ€™in temel yapÄ± taÅŸlarÄ±ndan biridir.  
Bir uygulamadaki bir Ã¶zelliÄŸin (feature) tÃ¼m **state**, **actions** ve **reducers** tanÄ±mlarÄ±nÄ± iÃ§inde barÄ±ndÄ±rÄ±r.  
Bu sayede kod daha modÃ¼ler, okunabilir ve yÃ¶netilebilir hale gelir.

> **KÄ±saca:** Bir feature = Bir Slice âœ…

---

## ğŸ“¦ **Slice Nedir?**

- **State:** UygulamanÄ±n o Ã¶zelliÄŸine ait veriler (Ã¶rneÄŸin, sayaÃ§ deÄŸeri, kullanÄ±cÄ± bilgileri, envanter listesi).  
- **Reducers:** Stateâ€™i deÄŸiÅŸtiren saf fonksiyonlar.  
- **Actions:** Reducers'Ä± tetikleyen olaylar. Redux Toolkit, bu actionâ€™larÄ± otomatik olarak oluÅŸturur.  

---

## âš¡ **1ï¸âƒ£ Slice NasÄ±l OluÅŸturulur?**

Redux Toolkit ile `createSlice` fonksiyonunu kullanarak slice oluÅŸturabiliriz.  

### ğŸ“„ **Ã–rnek: Basit Bir Counter Slice**

```javascript
// src/features/counter/counterSlice.js
import { createSlice } from '@reduxjs/toolkit';

// Slice TanÄ±mÄ±
const counterSlice = createSlice({
  name: 'counter', // Slice adÄ±
  initialState: { value: 0 }, // BaÅŸlangÄ±Ã§ state
  reducers: {
    increment: (state) => {
      state.value += 1; // State doÄŸrudan deÄŸiÅŸtirilebilir (immer.js sayesinde)
    },
    decrement: (state) => {
      state.value -= 1;
    },
    incrementByAmount: (state, action) => {
      state.value += action.payload; // Payload ile veri gÃ¼ncelleme
    },
  },
});

// Action ve Reducerâ€™larÄ± dÄ±ÅŸa aktarma
export const { increment, decrement, incrementByAmount } = counterSlice.actions;
export default counterSlice.reducer;
```

### ğŸ¯ **AÃ§Ä±klama:**
- **`name`**: Sliceâ€™Ä±n benzersiz adÄ±dÄ±r. (Ã–rneÄŸin, `counter`, `user`, `inventory`)  
- **`initialState`**: BaÅŸlangÄ±Ã§ verisidir.  
- **`reducers`**: Stateâ€™i deÄŸiÅŸtiren fonksiyonlar.  
- **`actions`**: Reducerâ€™lara karÅŸÄ±lÄ±k gelen otomatik oluÅŸturulmuÅŸ action creatorâ€™lar.  

---

## ğŸš€ **2ï¸âƒ£ Birden Fazla State ile Slice YapÄ±sÄ±**

Bir slice sadece bir state yÃ¶netmek zorunda deÄŸildir. Ã–rneÄŸin bir kullanÄ±cÄ± (user) slice dÃ¼ÅŸÃ¼nelim:

### ğŸ“„ **User Slice Ã–rneÄŸi**

```javascript
// src/features/user/userSlice.js
import { createSlice } from '@reduxjs/toolkit';

const userSlice = createSlice({
  name: 'user',
  initialState: {
    isLoggedIn: false,
    userInfo: null,
  },
  reducers: {
    login: (state, action) => {
      state.isLoggedIn = true;
      state.userInfo = action.payload; // KullanÄ±cÄ± bilgilerini kaydet
    },
    logout: (state) => {
      state.isLoggedIn = false;
      state.userInfo = null; // KullanÄ±cÄ±yÄ± Ã§Ä±kÄ±ÅŸ yaptÄ±r
    },
  },
});

export const { login, logout } = userSlice.actions;
export default userSlice.reducer;
```

### ğŸ¯ **AÃ§Ä±klama:**
- **`login`** reducerâ€™Ä± ile kullanÄ±cÄ± giriÅŸ yapar, `payload` iÃ§indeki bilgileri kaydederiz.  
- **`logout`** reducerâ€™Ä± ile kullanÄ±cÄ±yÄ± Ã§Ä±kÄ±ÅŸ yaptÄ±rÄ±rÄ±z.  

---

## ğŸ”„ **3ï¸âƒ£ Payload ile Ã‡alÄ±ÅŸmak**

Bir reducer fonksiyonuna ek veri gÃ¶ndermek iÃ§in **payload** kullanÄ±lÄ±r.

### âœ… **Ã–rnek: Payload KullanÄ±mÄ±**

```javascript
dispatch(incrementByAmount(10));  // 10 sayÄ±sÄ±nÄ± gÃ¶nderiyoruz
```

Reducerâ€™da payloadâ€™a ÅŸu ÅŸekilde eriÅŸilir:

```javascript
incrementByAmount: (state, action) => {
  state.value += action.payload;  // action.payload = 10
}
```

---

## â±ï¸ **4ï¸âƒ£ Asenkron Ä°ÅŸlemler iÃ§in Slice (API Ã‡aÄŸrÄ±larÄ±)**

Asenkron iÅŸlemleri yÃ¶netmek iÃ§in **`createAsyncThunk`** kullanÄ±lÄ±r.

### ğŸ“„ **User Slice Asenkron API Ã‡aÄŸrÄ±sÄ±**

```javascript
// src/features/user/userSlice.js
import { createSlice, createAsyncThunk } from '@reduxjs/toolkit';

// API'den kullanÄ±cÄ± verisi Ã§ek
export const fetchUsers = createAsyncThunk('user/fetchUsers', async () => {
  const response = await fetch('https://jsonplaceholder.typicode.com/users');
  return response.json();
});

const userSlice = createSlice({
  name: 'user',
  initialState: {
    users: [],
    status: 'idle', // idle, loading, succeeded, failed
    error: null,
  },
  reducers: {},
  extraReducers: (builder) => {
    builder
      .addCase(fetchUsers.pending, (state) => {
        state.status = 'loading';  // YÃ¼kleme baÅŸlÄ±yor
      })
      .addCase(fetchUsers.fulfilled, (state, action) => {
        state.status = 'succeeded';  // API baÅŸarÄ±lÄ±
        state.users = action.payload; // Gelen veriyi kaydet
      })
      .addCase(fetchUsers.rejected, (state, action) => {
        state.status = 'failed';  // Hata durumunda
        state.error = action.error.message;
      });
  },
});

export default userSlice.reducer;
```

### ğŸ¯ **AÃ§Ä±klama:**
- **`createAsyncThunk`**: API Ã§aÄŸrÄ±sÄ± yapar.  
- **`pending`**, **`fulfilled`**, **`rejected`** durumlarÄ± otomatik gelir.  
- **`extraReducers`**: Asenkron iÅŸlemleri yÃ¶netir.  

---

## ğŸ—‚ï¸ **5ï¸âƒ£ Store ile Slice'Ä± BaÄŸlama**

Her slice oluÅŸturduktan sonra **store**'a baÄŸlamamÄ±z gerekiyor.

### ğŸ“„ **store.js**

```javascript
// src/app/store.js
import { configureStore } from '@reduxjs/toolkit';
import counterReducer from '../features/counter/counterSlice';
import userReducer from '../features/user/userSlice';

export const store = configureStore({
  reducer: {
    counter: counterReducer,
    user: userReducer,
  },
});
```

---

## ğŸš€ **6ï¸âƒ£ Slice KullanÄ±mÄ± (Dispatch ve Selector)**

### ğŸ“„ **Counter Component**

```javascript
// src/features/counter/Counter.js
import { useSelector, useDispatch } from 'react-redux';
import { increment, decrement, incrementByAmount } from './counterSlice';

function Counter() {
  const count = useSelector((state) => state.counter.value);
  const dispatch = useDispatch();

  return (
    <div>
      <h2>Counter: {count}</h2>
      <button onClick={() => dispatch(increment())}>+1</button>
      <button onClick={() => dispatch(decrement())}>-1</button>
      <button onClick={() => dispatch(incrementByAmount(5))}>+5</button>
    </div>
  );
}

export default Counter;
```

### ğŸ“„ **User Component (Asenkron API KullanÄ±mÄ±)**

```javascript
// src/features/user/UserList.js
import { useEffect } from 'react';
import { useSelector, useDispatch } from 'react-redux';
import { fetchUsers } from './userSlice';

function UserList() {
  const dispatch = useDispatch();
  const users = useSelector((state) => state.user.users);
  const status = useSelector((state) => state.user.status);
  const error = useSelector((state) => state.user.error);

  useEffect(() => {
    dispatch(fetchUsers()); // API Ã§aÄŸrÄ±sÄ±
  }, [dispatch]);

  return (
    <div>
      <h2>Users</h2>
      {status === 'loading' && <p>Loading...</p>}
      {status === 'failed' && <p>Error: {error}</p>}
      {users.map((user) => (
        <p key={user.id}>{user.name}</p>
      ))}
    </div>
  );
}

export default UserList;
```

---

## ğŸ¯ **7ï¸âƒ£ Slice YapÄ±sÄ±nÄ±n GÃ¼Ã§lÃ¼ YÃ¶nleri**

- âœ… **ModÃ¼lerlik:** Her feature iÃ§in ayrÄ± slice oluÅŸturabilirsin.  
- âœ… **Otomatik Action:** Action creatorâ€™larÄ± elle yazmana gerek kalmaz.  
- âœ… **Kolay Asenkron YÃ¶netimi:** API iÅŸlemleri `createAsyncThunk` ile basitleÅŸir.  
- âœ… **Immer.js Entegrasyonu:** State doÄŸrudan deÄŸiÅŸtirilebilir (immutable yapÄ±yÄ± otomatik korur).  

---

## ğŸš€ **8ï¸âƒ£ Tam KlasÃ¶r YapÄ±sÄ±**

```
src/
â”œâ”€â”€ app/
â”‚   â””â”€â”€ store.js
â”œâ”€â”€ features/
â”‚   â”œâ”€â”€ counter/
â”‚   â”‚   â”œâ”€â”€ Counter.js
â”‚   â”‚   â””â”€â”€ counterSlice.js
â”‚   â””â”€â”€ user/
â”‚       â”œâ”€â”€ UserList.js
â”‚       â””â”€â”€ userSlice.js
â”œâ”€â”€ App.js
â””â”€â”€ main.jsx
```

---

## âœ… **Ã–zet:**

1. **`createSlice`** ile state ve reducer tanÄ±mlanÄ±r.  
2. Actionâ€™lar otomatik olarak oluÅŸturulur.  
3. Asenkron iÅŸlemler iÃ§in `createAsyncThunk` kullanÄ±lÄ±r.  
4. Sliceâ€™lar `store` ile baÄŸlanÄ±r.  
5. `useDispatch` ve `useSelector` ile React bileÅŸenlerinde kullanÄ±lÄ±r.  

Dilersen ÅŸimdi bir sonraki adÄ±mda **asenkron iÅŸlemler (API Ã§aÄŸrÄ±larÄ±)** konusunda daha derinlemesine bir Ã¶rnek yapabiliriz. ğŸš€